<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>ms-office-with-pywin32com | 绿萝间</title>

                <link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">

                <link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml">

      <link rel="canonical" href="http://muxuezi.github.io/posts/ms-office-with-pywin32com.html">



    
<script type="text/javascript">
MathJax.Hub.Config({
    tex2jax: {
         inlineMath: [ ['$','$'], ["\\(","\\)"] ],
         displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
             },
         displayAlign: 'center', // Change this to 'center' to center equations.
         "HTML-CSS": {
             styles: {'.MathJax_Display': {"margin": 0}}
     }
});
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>

        <!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->

    

    
    <meta name="author" content="tj2">
        <meta property="og:site_name" content="绿萝间">
    <meta property="og:title" content="ms-office-with-pywin32com">
    <meta property="og:url" content="http://muxuezi.github.io/posts/ms-office-with-pywin32com.html">
    <meta property="og:description" content="Python调用COM的API实现Microsoft Office(PPT, Excel, Word)办公自动化






In [ ]:


 



  hide output










Automating Microsoft Office with Python¶Windows applications, for many years, have provided a COM ">
    <meta property="og:type" content="article">
    <meta property="article:published_time" content="2015-06-24T13:44:54+08:00">
           <meta property="article:tag" content="CHS">
           <meta property="article:tag" content="ipython">
           <meta property="article:tag" content="Other">
           <meta property="article:tag" content="Python">

    
    

</head>
<body>
    <section class="social">
        <ul>
                    <li><a href="../index.html" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="../archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="../categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="../rss.xml" title="RSS"><i class="icon-rss"></i></a></li>
            <li><a href="https://twitter.com/muxuezi" title="My Twitter"><i class="icon-twitter"></i></a></li>
            <li><a href="https://github.com/muxuezi" title="My Github"><i class="icon-github"></i></a></li>

        </ul>
    </section>
    <section class="page-content">
        <div class="content" rel="main">
    <div class="post">
        <h1 class="p-name entry-title" itemprop="headline name">ms-office-with-pywin32com</h1>

        <div class="meta">
            <div class="authordate">
                <time class="timeago" datetime="2015-06-24T13:44:54+08:00">2015-06-24 13:44</time>
            
                      |  
        <a href="ms-office-with-pywin32com.ipynb" id="sourcelink">Source</a>
          |  
        <a href="javascript:%24.getScript(%22/assets/js/miniPageNav.js%22);">Minimap</a>

            </div>
                    <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="../categories/chs.html" rel="tag">CHS</a></li>
           <li><a class="tag p-category" href="../categories/ipython.html" rel="tag">ipython</a></li>
           <li><a class="tag p-category" href="../categories/other.html" rel="tag">Other</a></li>
           <li><a class="tag p-category" href="../categories/python.html" rel="tag">Python</a></li>
        </ul>
        </div>

        </div>
        <div class="body">
            <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Python调用COM的API实现Microsoft Office(PPT, Excel, Word)办公自动化</p>
<!-- TEASER_END -->
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Automating-Microsoft-Office-with-Python">Automating Microsoft Office with Python<a class="anchor-link" href="ms-office-with-pywin32com.html#Automating-Microsoft-Office-with-Python">¶</a>
</h2>
<p>Windows applications, for many years, have provided a <a href="http://en.wikipedia.org/wiki/Component_Object_Model">COM</a> API for automation. This includes Microsoft Office as well.</p>
<p><a href="http://sourceforge.net/projects/pywin32/">pywin32</a> is a library that lets you do many interesting things in Windows, including access these COM APIs.</p>
<p>For example, to open PowerPoint and draw a circle, this is what it takes:</p>
<h2 id="Python实现Microsoft-Office办公自动化">Python实现Microsoft Office办公自动化<a class="anchor-link" href="ms-office-with-pywin32com.html#Python%E5%AE%9E%E7%8E%B0Microsoft-Office%E5%8A%9E%E5%85%AC%E8%87%AA%E5%8A%A8%E5%8C%96">¶</a>
</h2>
<p>多年以前，微软就为Windows软件出了<a href="http://en.wikipedia.org/wiki/Component_Object_Model">COM</a>组件，便于调用其API实现自动化，也包括Microsoft Office。</p>
<p><a href="http://sourceforge.net/projects/pywin32/">pywin32</a>就是这样的库，能让你在Windows上做很多有趣的事儿，包括调用COM的API。</p>
<p>例如，要打开PPT画个圈儿，可以这么做：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

<div class="output_wrapper output_hidden">
<div class="output">

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

</div>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You'll have to try this out to see the result, but just FYI, this will open a new PowerPoint window and add a slide with a circle in it.</p>
<p>This opens up a lot of opportunities for slideware. Similarly, we can open an Excel application, add a circle, and change a few cells.</p>
<p>你看，运行之后就能看到结果：打开一个PPT，新建一页，然后在上面画一个圈儿。</p>
<p>这为幻灯片制作开启了新思路。当然，我们也可以打开一个Excel，在上面画一个圈儿，向单元格添加内容。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

<div class="output_wrapper output_hidden">
<div class="output">

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

</div>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This means one can go about creating Excel models directly with Python.</p>
<p>看到了吧，可以直接通过python建立Excel。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Picturing-the-IMDb-Top-250">Picturing the IMDb Top 250<a class="anchor-link" href="ms-office-with-pywin32com.html#Picturing-the-IMDb-Top-250">¶</a>
</h2>
<p>Let's begin by creating a slide that shows all of the <a href="http://www.imdb.com/chart/top">Top 250 movies</a> on the IMDb.</p>
<p>First, let's load all the movies.</p>
<h2 id="画图——IMDb-Top-250">画图——IMDb Top 250<a class="anchor-link" href="ms-office-with-pywin32com.html#%E7%94%BB%E5%9B%BE%E2%80%94%E2%80%94IMDb-Top-250">¶</a>
</h2>
<p>让我们做点儿更好玩儿的，用PPT显示IMDb的<a href="http://www.imdb.com/chart/top">Top 250 电影</a>。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

<div class="output_wrapper output_hidden">
<div class="output">

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

</div>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can show these movies. But before that, we can't remember these numbers for the shapes (like 9 is for circle). Let's pre-define those in line with how Office uses them and import them.</p>
<p>用<a href="http://lxml.de/">lxml</a>可以轻松获取数据（<a href="http://www.crummy.com/software/BeautifulSoup/">BeautifulSoup</a>也行）。但是，我们记不住形状对应数字（如9表示椭圆oval，5表示矩形rectangle），让我们先看看这些数字Office是如何用的。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's draw each movie poster as a little box on a 25x10 grid. We don't have the images yet, but first, let's just draw the rectangles.</p>
<p>我们把每部电影的海报放到25列10行的栅格里，每个格子宽28高41。抓图片之前，我们先把格子都画好。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

<div class="output_wrapper output_hidden">
<div class="output">

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

</div>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It would be nice to get posters into those, so let's scrape the posters.</p>
<p>海报放框里应该会好看点，下面我们抓海报。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, instead of just rectangles, we'll use the posters.</p>
<p>现在，我们用这些海报来填充。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

<div class="output_wrapper output_hidden">
<div class="output">

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

</div>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Wouldn't it be nice to have these hyperlinked to the movies?</p>
<p>要是海报能链接到每部电影就更帅了。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is ordered by rank, which is useful, but this makes it hard to locate a specific movie. What if we could sort this alphabetically?</p>
<p>But then, we don't want to lose the ordering by rank either. Could we, perhaps, get these movies to move on the click of a button to alphabetical or rank order?</p>
<p>Let's start by adding two buttons -- one to sort alphabetically and the ohter to sort by rank.</p>
<p>这是按照评分排序的，通常如此，但是很难定位到某一个电影。要是按字母排序呢？</p>
<p>但是，我们也不想丢失评分排序。那么，我们能不能加个按钮，让这些电影分别按字母/评分排序？</p>
<p>让我们加两个按钮吧——分别按字母/评分排序。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll create a function that moves an image along a path when a trigger is clicked. This will be applied to each of the images.</p>
<p>我们建一个函数实现让按钮按下的时候，电影图片会沿着一个路径移动，然后将函数应用到每张图片。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we draw all the images. After drawing them, we specify one animation for alphabetical ordering, and another for ordering by rating.</p>
<p>最后，我们将函数应用到所有图片上。之后，我们指定一个动画为按字母排序，另一个动画为按评分排序。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

<div class="output_wrapper output_hidden">
<div class="output">

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

</div>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Simple-Treemap">
<a href="http://www.s-anand.net/blog/automating-powerpoint-with-python/">Simple Treemap</a><a class="anchor-link" href="ms-office-with-pywin32com.html#Simple-Treemap">¶</a>
</h2>
<p>Let’s do something that you’d have trouble doing manually in PowerPoint: a <a href="http://www.cs.umd.edu/hcil/treemap-history/">Treemap</a>. The <a href="http://www.guardian.co.uk/">Guardian’s</a> <a href="http://www.guardian.co.uk/data-store">data store</a> kindly makes available the <a href="http://spreadsheets.google.com/pub?key=phNtm3LmDZEOoyu8eDzdSXw">top 50 banks by assets</a> that we’ll use for this example. Our target output is a simple Treemap visualisation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="简单的矩形树状结构图">简单的矩形树状结构图<a class="anchor-link" href="ms-office-with-pywin32com.html#%E7%AE%80%E5%8D%95%E7%9A%84%E7%9F%A9%E5%BD%A2%E6%A0%91%E7%8A%B6%E7%BB%93%E6%9E%84%E5%9B%BE">¶</a>
</h2>
<p>我们再用PPT做一个费事的<a href="http://www.cs.umd.edu/hcil/treemap-history/">Treemap</a>。我们将使用<a href="http://www.guardian.co.uk/">Guardian’s</a> <a href="http://www.guardian.co.uk/data-store">data store</a>里面的<a href="http://spreadsheets.google.com/pub?key=phNtm3LmDZEOoyu8eDzdSXw">top 50 banks by assets</a>数据来做一个简单的<a href="http://zh.wikipedia.org/wiki/%E7%9F%A9%E5%BD%A2%E5%BC%8F%E6%A0%91%E7%8A%B6%E7%BB%93%E6%9E%84%E7%BB%98%E5%9B%BE%E6%B3%95">矩形树状结构图</a>。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now let’s import data from The Guardian. The spreadsheet is <a href="http://spreadsheets.google.com/pub?key=phNtm3LmDZEOoyu8eDzdSXw">Google Spreadsheets</a> and we can get just the banks and assets as a CSV file by adding "&amp;output=csv&amp;range=B2:C51" (via <a href="http://blog.ouseful.info/2009/03/10/using-many-eyes-wikified-to-visualise-guardian-data-store-data-on-google-docs/">OUseful.Info</a>).</p>
<p>现在我们导入数据Guardian. 数据在<a href="http://spreadsheets.google.com/pub?key=phNtm3LmDZEOoyu8eDzdSXw">Google Spreadsheets</a>，我们可以通过在链接后面增加"&amp;output=csv&amp;range=B2:C51"获取数据 (参考 <a href="http://blog.ouseful.info/2009/03/10/using-many-eyes-wikified-to-visualise-guardian-data-store-data-on-google-docs/">OUseful.Info</a>).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I created a simple Treemap class based on the <a href="http://www.win.tue.nl/~vanwijk/stm.pdf">squarified algorithm</a> — you can play with the <a href="http://www.s-anand.net/treemap.zip">source code</a>. This Treemap class can be fed the the data in the format we have, and a draw function. The draw function takes (x, y, width, height, data_item) as parameters, where data_item is a row in the data list that we pass to it.</p>
<p>我用<a href="http://www.win.tue.nl/~vanwijk/stm.pdf">squarified algorithm</a>建了一个simple Treemap类，你可以在<a href="http://www.s-anand.net/treemap.zip">源代码</a>看到。这个Treemap类可以把数据转换成指定的格式。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>还包括一个画图函数。画图函数参数为(x, y, width, height, data_item)，其中data_item是输入数据。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

<div class="output_wrapper output_hidden">
<div class="output">

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

</div>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

<div class="output_wrapper output_hidden">
<div class="output">

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

</div>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Real-life-examples">Real-life examples<a class="anchor-link" href="ms-office-with-pywin32com.html#Real-life-examples">¶</a>
</h2>
<p>You can see how these were put to use at <a href="http://gramener.com/">Gramener</a>:</p>
<ul>
<li>
<a href="http://gramener.com/vijaykarnataka/">Vijay Karnataka's election coverage</a> was produced entirely in PowerPoint using Python. (And in Kannada, no less!)</li>
<li>
<a href="http://gramener.com/appstore/appstore.pptx">Appstore downloads</a> -- a mini interactive application that shows the number of downloads from an app store, broken up by country, device, customer segment and time.</li>
<li>
<a href="http://gramener.com/fmcg/fmcg-revenue-breakup.pptx">Revenue breakup</a> of an FMCG company as a clickable application</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="企业案例">企业案例<a class="anchor-link" href="ms-office-with-pywin32com.html#%E4%BC%81%E4%B8%9A%E6%A1%88%E4%BE%8B">¶</a>
</h2>
<p>你可以在<a href="http://gramener.com/">Gramener</a>看到很多这样的东东:</p>
<ul>
<li>
<a href="http://gramener.com/vijaykarnataka/">Vijay Karnataka's election coverage</a>全是Python做的PPT（密集症慎入）。</li>
<li>
<a href="http://gramener.com/appstore/appstore.pptx">Appstore downloads</a> -- 一个显示一个app store下载数量的交互应用，按照国家、设备、客户群和时间排序。</li>
<li>
<a href="http://gramener.com/fmcg/fmcg-revenue-breakup.pptx">Revenue breakup</a> of an 快速消费品(FMCG,Fast Moving Consumer Goods)的应用。</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Live-tweeting">Live tweeting<a class="anchor-link" href="ms-office-with-pywin32com.html#Live-tweeting">¶</a>
</h2>
<p>Just for kicks, let's use PowerPoint as a dashboard to show live tweets.</p>
<p>I picked <a href="https://github.com/geduldig/TwitterAPI">TwitterAPI</a> to get streaming results, but <a href="https://github.com/ryanmcgrath/twython">twython</a> and <a href="https://github.com/sixohsix/twitter">Python Twitter Tools</a> look fine too.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Live-tweeting">Live tweeting<a class="anchor-link" href="ms-office-with-pywin32com.html#Live-tweeting">¶</a>
</h2>
<p>让我们用PPT做一个dashboard来显示tweets信息。良好的网络环境是前提。</p>
<p>我用<a href="https://github.com/geduldig/TwitterAPI">TwitterAPI</a>来获取信息，<a href="https://github.com/ryanmcgrath/twython">twython</a>和<a href="https://github.com/sixohsix/twitter">Python Twitter Tools</a>当然也行。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This function will draw a tweet in a reasonably nice way on a slide. There's a block each for the profile picture, the text of the tweet, and the name of the user.</p>
<p>这个函数会让tweet在幻灯片中漂亮地呈现。包括配置图片，tweet内容，用户名。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's track requests for specific words, and see what we get.</p>
<p>让我们来看看跟踪的结果。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

<i class="icon-hand-up icon-large" style="float:right; margin-bottom:8px; margin-right:10px">
  hide output</i>
</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>GAME OVER</strong></p>

</div>
</div>
</div>
</div>
        </div>
                <ul class="pager">
            <li class="previous">
                <a href="kivy-ch9-shmup-app.html" rel="prev" title="kivy-ch9-shmup-app">Previous post</a>
            </li>
            <li class="next">
                <a href="kivy-ch1-clock-app.html" rel="next" title="kivy-ch1-clock-app">Next post</a>
            </li>
        </ul>

                            <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="tj2",
            disqus_url="http://muxuezi.github.io/posts/ms-office-with-pywin32com.html",
        disqus_title="ms-office-with-pywin32com",
        disqus_identifier="cache/posts/ms-office-with-pywin32com.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        
    </div>
                    <footer id="footer" role="contentinfo">
            <p>Contents © 2015         <a href="mailto:muxuezi@gmail.com">tj2</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/ar/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="http://i.creativecommons.org/l/by-nc-sa/2.5/ar/88x31.png"></a></p>
            
        </footer>

        </div>
    </section>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-51330059-1', 'auto');
  ga('send', 'pageview');

</script>

    
                <script src="../assets/js/all-nocdn.js" type="text/javascript"></script>
    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul>
<li>
<a class="addthis_button_facebook"></a>
</li>
<li>
<a class="addthis_button_google_plusone_share"></a>
</li>
<li>
<a class="addthis_button_linkedin"></a>
</li>
<li>
<a class="addthis_button_twitter"></a>
</li>
</ul>
</div>
<script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


        <script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script>
</body>
</html>
